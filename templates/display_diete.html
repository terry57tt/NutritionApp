{% extends 'base.html' %}

{% if not navbar_included %}
    {% set navbar_included = true %}
    {% include "navbar.html" %}
{% endif %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages.css') }}">
<div class="content">
    <h2 class="title text-center">{% block title %} {{ diete.titre_diete }} {% endblock %}</h2>
    {% set current_label = [] %}
    {% for portion in diete.portions_associees() %}
        {% if current_label[-1] != portion.label_portion %}
            <table class="table table-striped table-bordered">
                {% do current_label.append(portion.label_portion) %}
                    <tr>
                        <th colspan="4">
                            {% if current_label[-1] == 1 %}
                                Matin
                            {% elif current_label[-1] == 3 %}
                                Midi
                            {% elif current_label[-1] == 5 %}
                                Soir
                            {% else %}
                                Collation
                            {% endif %}
                        </th>
                    </tr>
        {% endif %}
                <tr>
                    {% if portion.aliment_obj.unite == 1 %}
                        <td>{{ portion.nombre }}</td>
                        <td>{{ portion.aliment_obj.titre }}</td>
                    {% else %}
                        <td>{{ portion.nombre }} g</td>
                        <td>{{ portion.aliment_obj.titre }}</td>
                    {% endif %}
                        <td>{{ portion.kcal_portion() }} kcal</td>
                        <td>{{ portion.proteines_portion() }} g de protéines</td>
                </tr>
    {% endfor %}
    <table class="table table-striped table-bordered">
        <tr>
            <th colspan="2">Total</th>
            <td>{{ diete.total_kcal()|round|int }} kcal</td>
            <td>{{ diete.total_proteines()|round|int }} g de protéines</td>
        </tr>
    </table>
</div>
{% endblock %}
